<app-navbar></app-navbar>

<section class="mb-page">
  <div class="mb-container">
    <h2 class="mb-title">My Bookings</h2>

    <div *ngIf="loading" class="mb-status">Loading…</div>
    <div *ngIf="!loading && error" class="error">{{ error }}</div>
    <div *ngIf="!loading && !error && bookings.length === 0" class="mb-status">
      No bookings yet.
    </div>

    <div *ngIf="!loading && !error && bookings.length" class="mb-table-wrapper">
      <table class="mb-table">
        <thead>
          <tr>
            <th>#</th>
            <th>From → To</th>
            <th>Go Flight</th>
            <th>Return Flight</th>
            <th>Cabin</th>
            <th>Amount</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let b of bookings; trackBy: trackById">
            <td>{{ b.id }}</td>
            <td>{{ b.goFlightDeparture }} → {{ b.goFlightArrival }}</td>
            <td>
              <div class="mini">ID: {{ b.goFlightId }}</div>
              {{ b.goFlightDeparture }} → {{ b.goFlightArrival }}
            </td>
            <td>
              <ng-container *ngIf="b.returnFlightId; else noReturn">
                <div class="mini">ID: {{ b.returnFlightId }}</div>
                {{ b.returnFlightDeparture }} → {{ b.returnFlightArrival }}
              </ng-container>
              <ng-template #noReturn>—</ng-template>
            </td>
            <td class="highlight">{{ goCabin(b) }} / {{ retCabin(b) }}</td>
            <td class="highlight">
              {{ toAmount(b) | currency: currencyCode(b): 'symbol':'1.2-2' }}
            </td>
            <td>{{ b.createdAt | date:'medium' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>
